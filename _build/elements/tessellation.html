---
interact_link: content/elements/tessellation.ipynb
kernel_name: mmp_guide
has_widgets: false
title: |-
  Morphological tessellation
prev_page:
  url: /elements/elements.html
  title: |-
    Generating morphological elements
next_page:
  url: /elements/blocks.html
  title: |-
    Tessellation-based blocks
suffix: .ipynb

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Generating-morphological-tessellation">Generating morphological tessellation<a class="anchor-link" href="#Generating-morphological-tessellation"> </a></h1><h2 id="Using-exemplary-data">Using exemplary data<a class="anchor-link" href="#Using-exemplary-data"> </a></h2><p>One of the main features of <code>momepy</code> is the ability to generate and analyse morphological tessellation (MT). One can imagine MT like Voronoi tessellation generated around building polygons instead of points. The similarity is not accidental - the core of MT is a Voronoi diagram generated by <code>scipy.spatial.Voronoi</code>. We'll explain key parts of tessellation and explore its application in the real world.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">momepy</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">buildings</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">momepy</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_path</span><span class="p">(</span><span class="s1">&#39;bubenec&#39;</span><span class="p">),</span>
                          <span class="n">layer</span><span class="o">=</span><span class="s1">&#39;buildings&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered tag_hide_input">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">buildings</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/elements/tessellation_3_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To generate MT, each building needs to have an <code>unique_id</code> assigned, which will later link generated cell to its parent building. Exemplar <code>GeoDataFrame</code> comes with such ID in <code>uID</code> column.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered tag_hide_input">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">buildings</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>uID</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>POLYGON ((1603599.221193187 6464369.815517657,...</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>POLYGON ((1603042.87977405 6464261.497778866, ...</td>
    </tr>
    <tr>
      <td>2</td>
      <td>3</td>
      <td>POLYGON ((1603044.649753952 6464178.034552199,...</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4</td>
      <td>POLYGON ((1603036.556826973 6464141.466502897,...</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>POLYGON ((1603082.38706133 6464142.02187786, 1...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As Voronoi tessellation tends to go to infinity for edge points, we have to define a limit for tessellation. It can be the area of your case study represented as a Polygon or MultiPolygon or you can use <code>momepy.buffered_limit</code> to generate such limit as a set maximal distance from buildings.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">limit</span> <span class="o">=</span> <span class="n">momepy</span><span class="o">.</span><span class="n">buffered_limit</span><span class="p">(</span><span class="n">buildings</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">limit</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" height="300" viewBox="1602857.8278684937 6463672.472907883 893.7380121811293 918.858507133089" preserveAspectRatio="xMinYMin meet"><g transform="matrix(1,0,0,-1,0,12928263.804322898)"><path fill-rule="evenodd" fill="#66cc99" stroke="#555555" stroke-width="6.12572338088726" opacity="0.6" d="M 1603606.8655848152,6463823.534777758 L 1603606.3077490872,6463820.609363737 L 1603597.257474485,6463783.018852257 L 1603594.4955586232,6463773.60367936 L 1603590.8242414645,6463764.504498615 L 1603586.2788681227,6463755.808911165 L 1603580.9031985705,6463747.6006326135 L 1603574.7489863462,6463739.958687062 L 1603567.8754803033,6463732.956646318 L 1603560.3488541998,6463726.661921589 L 1603552.2415696203,6463721.135114494 L 1603543.6316783605,6463716.429433629 L 1603534.6020709944,6463712.590182304 L 1603525.2396788576,6463709.654322399 L 1603515.6346371248,6463707.65011851 L 1603505.879417049,6463706.596865842 L 1603496.0679357038,6463706.504704444 L 1603486.2946518108,6463707.374521586 L 1603476.6536563514,6463709.197943223 L 1603466.189624218,6463711.714384896 L 1603464.8489774289,6463712.046600647 L 1603451.998447552,6463715.3253540015 L 1603448.3770833355,6463716.004036704 L 1603441.6979138898,6463717.600676781 L 1603436.4300209642,6463719.137695718 L 1603419.9996997404,6463723.112436233 L 1603414.8160274301,6463724.1127747595 L 1603413.602644981,6463724.4078063425 L 1603411.1925153888,6463725.025678954 L 1603410.5347299129,6463725.203061535 L 1603405.6977653962,6463726.108455095 L 1603404.751549725,6463726.334067537 L 1603402.822922056,6463726.918943688 L 1603400.4089866353,6463727.387540982 L 1603399.4182431658,6463727.630508264 L 1603397.7325715704,6463728.1513764635 L 1603394.9633178313,6463728.710566408 L 1603394.0059702082,6463728.953533718 L 1603392.9198647249,6463729.294120903 L 1603391.519442037,6463729.558393468 L 1603390.50643467,6463729.801360811 L 1603384.09278104,6463731.659473092 L 1603383.7121775611,6463731.758411879 L 1603379.196282964,6463733.017447678 L 1603347.365241514,6463740.773396377 L 1603313.502148759,6463748.884770858 L 1603304.1046385402,6463751.628561392 L 1603298.0631568544,6463754.055708084 L 1603292.5291234432,6463754.56066818 L 1603282.861366127,6463756.414690912 L 1603251.6754191306,6463764.003884511 L 1603230.2430181412,6463769.196023939 L 1603230.051643452,6463769.212048469 L 1603220.3530596986,6463770.998918389 L 1603213.5069110147,6463772.612923942 L 1603207.9592901147,6463774.167989516 L 1603205.9796978522,6463774.550549893 L 1603196.6738039867,6463777.307220783 L 1603196.3354244013,6463777.44437406 L 1603195.7724750715,6463777.607557869 L 1603186.5331717187,6463781.316518112 L 1603177.7084636101,6463785.925817336 L 1603169.3858222344,6463791.389767653 L 1603161.6477425387,6463797.65420978 L 1603156.3378028257,6463802.409455037 L 1603153.8912078799,6463804.793206948 L 1603151.4793036063,6463806.747487626 L 1603146.8038849945,6463810.930025317 L 1603144.3200798624,6463813.350515077 L 1603141.9906649499,6463815.2352651 L 1603136.6918571887,6463819.973165492 L 1603130.7139654018,6463825.784462605 L 1603128.7529561508,6463827.856684605 L 1603101.8942668855,6463852.104108087 L 1603094.9754432065,6463858.992338768 L 1603091.4467708028,6463863.268261291 L 1603086.3629181294,6463866.648028295 L 1603078.714065029,6463872.904107393 L 1603049.7416350285,6463899.093811871 L 1603025.0773040685,6463921.344013487 L 1603022.2341996555,6463924.174942923 L 1603018.933573859,6463927.386434227 L 1603018.531173532,6463927.862111641 L 1603018.0977955037,6463928.293633822 L 1603015.5715504999,6463931.360681935 L 1603012.6747815195,6463934.784952457 L 1603012.2746101255,6463935.36341118 L 1603011.8358069595,6463935.896150649 L 1603009.6499465788,6463939.157434303 L 1603007.1615069704,6463942.7545419885 L 1603006.7800982902,6463943.439221648 L 1603006.3520864642,6463944.077811369 L 1603004.5229983737,6463947.491018264 L 1603002.445525678,6463951.220359964 L 1603002.1000399508,6463952.012428927 L 1603001.699832008,6463952.759245069 L 1603000.237704017,6463956.282065487 L 1602998.571125684,6463960.102903419 L 1602987.0606903343,6463990.422427478 L 1602987.0390735276,6463990.488995119 L 1602987.011432695,6463990.55244888 L 1602981.265829331,6464005.7505363505 L 1602979.9295415739,6464008.2264968725 L 1602976.2486329966,6464016.921852759 L 1602969.447012108,6464035.370534986 L 1602966.9353358545,6464043.148909075 L 1602964.4863070587,6464051.948059797 L 1602963.0236941741,6464058.421416985 L 1602960.0636726194,6464063.737830049 L 1602956.1548894085,6464072.733498629 L 1602954.147258175,6464078.053597991 L 1602950.5620736673,6464086.255927952 L 1602943.0814038883,6464105.937004178 L 1602940.0826404144,6464115.146713234 L 1602940.067085704,6464115.216968337 L 1602932.393630625,6464135.737965157 L 1602931.3597227398,6464138.971760083 L 1602929.8514399342,6464142.408147631 L 1602898.3591559888,6464225.142433678 L 1602895.3220078542,6464234.475288482 L 1602893.214366744,6464244.060918172 L 1602892.056534816,6464253.80698778 L 1602891.8596650541,6464263.619616882 L 1602892.6256538345,6464273.404283906 L 1602894.3471226597,6464283.066736632 L 1602897.0074892319,6464292.513900084 L 1602900.581127185,6464301.654773094 L 1602905.033612934,6464310.401304877 L 1602910.3220572656,6464318.669243203 L 1602916.3955184738,6464326.378945956 L 1602923.1954930648,6464333.45614831 L 1602930.6564792988,6464339.832678087 L 1602938.706608146,6464345.447112443 L 1602947.2683355745,6464350.245369526 L 1602956.259189506,6464354.181229428 L 1603111.1825248445,6464413.121449581 L 1603120.5183915368,6464416.157676748 L 1603130.1069827192,6464418.263858469 L 1603130.4920320022,6464418.309510209 L 1603131.401607004,6464418.959492159 L 1603139.9069453692,6464423.855121732 L 1603148.8511889726,6464427.893497145 L 1603172.3952612763,6464437.161537241 L 1603181.7820161602,6464440.329220748 L 1603182.6113855792,6464440.520224988 L 1603199.747103265,6464447.074803567 L 1603199.7678605767,6464447.081592453 L 1603199.7879792643,6464447.090428782 L 1603222.6647934362,6464455.829558695 L 1603245.3668805005,6464464.513977014 L 1603271.5414954966,6464474.560374631 L 1603271.5582745099,6464474.565884382 L 1603271.5745088165,6464474.573039179 L 1603302.2652924284,6464486.340393424 L 1603311.63442017,6464489.412088496 L 1603321.2605015722,6464491.5461976975 L 1603324.9482813457,6464491.989123761 L 1603327.751619241,6464493.956319655 L 1603336.2139096193,6464498.741406161 L 1603345.100844489,6464502.682192878 L 1603354.1733829891,6464506.18811094 L 1603361.510401843,6464508.616463136 L 1603367.6101635527,6464511.321240753 L 1603376.8274173907,6464514.8792306045 L 1603386.1594531354,6464517.963784483 L 1603395.7492166492,6464520.117339574 L 1603405.5040695085,6464521.319092238 L 1603412.866495033,6464521.497681786 L 1603418.031667604,6464524.910372499 L 1603426.008831545,6464529.198856144 L 1603434.3412810382,6464532.748014065 L 1603436.9906849188,6464533.737311154 L 1603440.6059867875,6464534.879791566 L 1603444.0147400403,6464536.444483591 L 1603446.719803668,6464537.520561715 L 1603455.5178993032,6464540.554396743 L 1603464.55993203,6464542.757187233 L 1603473.7675882229,6464544.109854678 L 1603474.995752518,6464544.174718984 L 1603483.818431138,6464547.648199024 L 1603493.207228662,6464550.8169292705 L 1603502.8635389064,6464553.040899322 L 1603510.9289278397,6464554.072661619 L 1603519.4068599753,6464555.940222952 L 1603529.1715163107,6464557.10225571 L 1603539.0030920452,6464557.299618456 L 1603548.8065169887,6464556.530402713 L 1603558.4869931652,6464554.802046711 L 1603567.9509114996,6464552.131263448 L 1603569.9467342338,6464551.349273051 L 1603571.1533817914,6464551.025215289 L 1603580.3101862585,6464547.575870004 L 1603589.0860426093,6464543.2481227545 L 1603590.6665648553,6464542.265923471 L 1603593.2338375698,6464541.005088835 L 1603601.5410365677,6464535.86315198 L 1603609.3068324204,6464529.935126626 L 1603616.4571013283,6464523.277595224 L 1603622.9235946403,6464515.954103293 L 1603628.6445902789,6464508.034552881 L 1603633.565481873,6464499.594535361 L 1603637.6392999701,6464490.714609914 L 1603638.1958974234,6464489.326120557 L 1603638.2718007897,6464489.1362097645 L 1603639.3873991168,6464486.336670884 L 1603639.9126197356,6464485.029604499 L 1603642.5382236121,6464477.450961667 L 1603645.5784508926,6464475.51652414 L 1603652.5449417226,6464470.046667715 L 1603655.883202502,6464467.930870973 L 1603663.627790041,6464461.8801548425 L 1603671.364494652,6464455.198106043 L 1603678.5374795632,6464448.353488412 L 1603684.9974228095,6464440.832209512 L 1603690.6808228237,6464432.708203891 L 1603695.531811498,6464424.061330934 L 1603699.5027033698,6464414.976589838 L 1603702.554464372,6464405.543284063 L 1603704.6570955405,6464395.854143482 L 1603705.7899279054,6464386.004412832 L 1603705.9418256672,6464376.090915461 L 1603705.7393277518,6464373.682041956 L 1603707.8613430338,6464369.749294079 L 1603711.649334247,6464360.707654291 L 1603714.5338314886,6464351.3385666525 L 1603716.4871147033,6464341.732068217 L 1603717.4904128143,6464331.9804775575 L 1603717.5340841145,6464322.177507583 L 1603716.6177089214,6464312.417364961 L 1603714.750093613,6464302.793844786 L 1603710.408633472,6464285.10824886 L 1603707.6041491937,6464275.703684901 L 1603706.1829259621,6464272.226286566 L 1603705.9708712213,6464270.207927236 L 1603705.97862835,6464269.806597799 L 1603705.2068031847,6464260.030030259 L 1603703.4810562965,6464250.376078496 L 1603701.199006736,6464240.4486005185 L 1603698.4904052105,6464230.87488366 L 1603694.8438525775,6464221.617711813 L 1603693.4658552436,6464218.936798411 L 1603693.1634530898,6464217.677624728 L 1603692.8616496657,6464214.397553774 L 1603691.038755092,6464204.861457506 L 1603687.8550176558,6464191.7058864245 L 1603687.7903234425,6464191.4862717725 L 1603687.9503132182,6464190.718258233 L 1603689.0003695535,6464180.959242783 L 1603689.0886408982,6464171.144294538 L 1603688.2142768379,6464161.367971693 L 1603686.3857010829,6464151.724460321 L 1603677.8363641896,6464116.24981781 L 1603677.8028076333,6464116.135699641 L 1603677.779971565,6464116.017046272 L 1603670.8128680899,6464087.40872522 L 1603653.9937936766,6464017.737909756 L 1603653.9463239186,6464017.57645106 L 1603653.914461151,6464017.411686747 L 1603645.4541798483,6463982.8747957675 L 1603642.7028155506,6463973.607103719 L 1603639.3397928623,6463965.315080307 L 1603638.6888284944,6463957.891872217 L 1603636.8273795086,6463948.076276668 L 1603628.7962205634,6463914.883090285 L 1603622.4677010337,6463888.337126749 L 1603622.4179480004,6463888.166141956 L 1603622.3846089158,6463887.991311198 L 1603617.4426400631,6463867.583485964 L 1603612.810041909,6463848.208568545 L 1603612.6847866315,6463847.639555131 L 1603612.5924662526,6463846.81219788 L 1603610.4705997622,6463836.95409894 L 1603606.8655848152,6463823.534777758 z" /></g></svg>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Other crucial attributes of tessellation algorithm are <code>segment</code> and <code>shrink</code>. Both are predefined as balanced values between the computational demands and a quality of a result. Segment defines the maximal distance between points generated to represent building footprint, shrink defines how much should be building buffered (inwards) to generate a gap between adjacent polygons. If you want to reduce memory requirements, you can use larger <code>segment</code> distance, but it may cause imprecision.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tessellation</span> <span class="o">=</span> <span class="n">momepy</span><span class="o">.</span><span class="n">Tessellation</span><span class="p">(</span><span class="n">buildings</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="s1">&#39;uID&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>  0%|          | 0/144 [00:00&lt;?, ?it/s]</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Inward offset...
Discretization...
Generating input point array...
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 144/144 [00:00&lt;00:00, 315.01it/s]
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating Voronoi diagram...
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Vertices to Polygons:  13%|█▎        | 4153/32914 [00:00&lt;00:00, 41526.18it/s]</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating GeoDataFrame...
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Vertices to Polygons: 100%|██████████| 32914/32914 [00:00&lt;00:00, 35597.75it/s]
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Dissolving Voronoi polygons...
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 53/53 [00:00&lt;00:00, 335.87it/s]
  0%|          | 0/42 [00:00&lt;?, ?it/s]</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Preparing limit for edge resolving...
Building R-tree...
Identifying edge cells...
Cutting...
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 42/42 [00:00&lt;00:00, 662.74it/s]
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tessellation</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;momepy.elements.Tessellation at 0x116afec18&gt;</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>GeoDataFrame containing the tessellation itself can be accessed using <code>tessellation</code> attribute. Similarly, used values and input geometry can be accessed using <code>shrink</code>, <code>segment</code>, <code>limit</code> of <code>gdf</code> attributes.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tessellation_gdf</span> <span class="o">=</span> <span class="n">tessellation</span><span class="o">.</span><span class="n">tessellation</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tessellation</span><span class="o">.</span><span class="n">shrink</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.4</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered tag_hide_input">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">tessellation_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">buildings</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/elements/tessellation_14_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Generated tessellation can be linked to buildings using <code>unique_id</code>, being the common column between both <code>GeoDataFrames</code>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered tag_hide_input">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tessellation_gdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>uID</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>POLYGON ((1603586.677274485 6464344.667944215,...</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>POLYGON ((1603048.399497852 6464176.180701573,...</td>
    </tr>
    <tr>
      <td>2</td>
      <td>3</td>
      <td>POLYGON ((1603071.342637536 6464158.863329805,...</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4</td>
      <td>POLYGON ((1603055.834005827 6464093.614718676,...</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>POLYGON ((1603106.417554705 6464130.215958447,...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generating-tessellation-based-on-OpenStreetmap">Generating tessellation based on OpenStreetmap<a class="anchor-link" href="#Generating-tessellation-based-on-OpenStreetmap"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To illustrate a more real-life example, let's try to generate tessellation based on a small town retrieved from OSM. We will use <code>osmnx</code> package to get the data.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">osmnx</span> <span class="k">as</span> <span class="nn">ox</span>

<span class="n">gdf</span> <span class="o">=</span> <span class="n">ox</span><span class="o">.</span><span class="n">footprints</span><span class="o">.</span><span class="n">footprints_from_place</span><span class="p">(</span><span class="n">place</span><span class="o">=</span><span class="s1">&#39;Kahla, Germany&#39;</span><span class="p">)</span>
<span class="n">gdf_projected</span> <span class="o">=</span> <span class="n">ox</span><span class="o">.</span><span class="n">project_gdf</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered tag_hide_input">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">gdf_projected</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/elements/tessellation_20_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>While working with real-life data, we often face issues with their quality. To avoid some of the possible errors, we should preprocess (clean) the data. It is often done semi-manually within the GIS environment. <code>momepy</code> offers (experimental) <code>momepy.preprocess</code> to handle some of the expected issues.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">buildings</span> <span class="o">=</span> <span class="n">momepy</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">gdf_projected</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                              <span class="n">compactness</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">islands</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Loop 1 out of 2.
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Identifying changes: 100%|██████████| 2917/2917 [00:00&lt;00:00, 4816.32it/s]
Changing geometry: 100%|██████████| 31/31 [00:00&lt;00:00, 117.49it/s]
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Loop 2 out of 2.
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Identifying changes: 100%|██████████| 2505/2505 [00:00&lt;00:00, 3602.94it/s]
Changing geometry: 100%|██████████| 2/2 [00:00&lt;00:00, 98.19it/s]
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What has happened?</p>
<ol>
<li>All auxiliary buildings (smaller than 30 square meters defined in <code>size</code>) were dropped.</li>
<li>Possible adjacent structures of specific circular compactness values (long and narrow) were joined to their parental buildings.</li>
<li>All buildings fully within other buildings (share 100% of the exterior boundary) were joined to their parental buildings.</li>
</ol>
<p>Tessellation requires two other arguments: unique ID and limit. We will generate unique ID using <code>momepy.unique_id</code> and limit of tessellation using the same buffer method as above.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">buildings</span><span class="p">[</span><span class="s1">&#39;uID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">momepy</span><span class="o">.</span><span class="n">unique_id</span><span class="p">(</span><span class="n">buildings</span><span class="p">)</span>
<span class="n">limit</span> <span class="o">=</span> <span class="n">momepy</span><span class="o">.</span><span class="n">buffered_limit</span><span class="p">(</span><span class="n">buildings</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At this moment, we have everything we need to generate morphological tessellation. It might take a while for larger <code>GeoDataFrames</code>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tessellation</span> <span class="o">=</span> <span class="n">momepy</span><span class="o">.</span><span class="n">Tessellation</span><span class="p">(</span><span class="n">buildings</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="s1">&#39;uID&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">)</span>
<span class="n">tessellation_gdf</span> <span class="o">=</span> <span class="n">tessellation</span><span class="o">.</span><span class="n">tessellation</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Inward offset...
Discretization...
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>  1%|          | 28/2506 [00:00&lt;00:12, 194.09it/s]</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating input point array...
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 2506/2506 [00:03&lt;00:00, 641.66it/s]
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating Voronoi diagram...
Generating GeoDataFrame...
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Vertices to Polygons: 100%|██████████| 263754/263754 [00:07&lt;00:00, 36159.33it/s]
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Dissolving Voronoi polygons...
Preparing limit for edge resolving...
Building R-tree...
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 14%|█▍        | 52/373 [00:00&lt;00:00, 518.40it/s]</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Identifying edge cells...
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 373/373 [00:00&lt;00:00, 487.48it/s]
 18%|█▊        | 44/238 [00:00&lt;00:00, 434.33it/s]</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Cutting...
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 238/238 [00:00&lt;00:00, 427.75it/s]
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered tag_hide_input">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">tessellation_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">buildings</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/elements/tessellation_27_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Zooming closer to check the result:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">tessellation_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">buildings</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">681500</span><span class="p">,</span> <span class="mi">682500</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">5631000</span><span class="p">,</span> <span class="mi">5632000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/elements/tessellation_29_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And we are done. Morphological tessellation is generated and ready for any further analysis.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Troubleshooting">Troubleshooting<a class="anchor-link" href="#Troubleshooting"> </a></h3><p>In some cases, <code>momepy.tessellation</code> raises errors or warnings. In 99% of cases, this is due to errors in input data. Two types of warnings are possible:</p>
<ul>
<li><code>Tessellation does not fully match buildings. 10 element(s) collapsed "during generation - unique_id: [list of ids]</code></li>
</ul>
<p>In this case, some of the building shapes collapsed during the shrinkage. It should not happen as shrink distance is usually quite small, but you might be able to resolve it by setting smaller <code>shrink</code> distance. However, we would recommend fixing the data manually.</p>
<ul>
<li><code>Tessellation contains MultiPolygon elements. Initial objects should be edited. unique_id of affected elements: [list of ids]</code></li>
</ul>
<p>This is a more common issue, which is again caused by imprecise data. Often caused by long and extremely narrow shapes or overlap of buildings. While some of the analysis might work even with MultiPolygon geometry, it does not really make sense, so we would recommend fixing the data beforehand.</p>
<p>However, for most of the data of higher quality, you should not see any of these warnings.</p>

</div>
</div>
</div>
</div>

 


    </main>
    